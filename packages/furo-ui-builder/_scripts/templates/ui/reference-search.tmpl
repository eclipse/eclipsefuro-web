// Code generated by @furo/ui-builder. DO NOT EDIT.
// source: {{.source}}
import { LitElement, html, css } from 'lit';
import {Theme} from "@furo/framework/src/theme.js"
import {FBP} from "@furo/fbp";
import "@furo/data"
import "@furo/data-input"
import {i18n} from "@furo/framework/src/i18n.js"

{{range $import := .imports}}
import "{{$import}}";{{end}}

/**
 * `{{.component_name}}`
 *  Complete reference searcher for {{.type}}
 *
 *  {{.description}}
 *
 * @summary search {{.type}}
 * @customElement
 * @appliesMixin FBP
 */
class {{.class_name}} extends FBP(LitElement) {

  bindData(field){
    this.field = field;
    this._FBPTriggerWire("--field-injected", field);

    this.field.addEventListener("branch-value-changed", ()=>{
        if( !this.lock && this.field.link._value &&
          this.field.link._value.href && this.field.link._value.service) {
          this.lock = true;
          this._FBPTriggerWire('--htsUpdated', this.field.link._value);
          setTimeout(()=>{
            this.lock = false;
          },100);
        }
    });
  }

  /**
   * Themable Styles
   * @private
   * @return {CSSResult}
   */
  static get styles() {
    // language=CSS
    return Theme.getThemeForComponent('{{.theme}}') || css`
        :host {
            display: block;
        }

        :host([hidden]) {
            display: none;
        }
        furo-data-reference-search{
            width:100%;
        }
    `
  }

  static get properties() {
    return {
      /**
       * The default style (md like) supports a condensed form. It is a little bit smaller then the default
       */
      condensed: {
        type: Boolean
      }
    };
  }

  /**
   * @private
   * @returns {TemplateResult}
   * @private
   */
  render() {
    // language=HTML
    return html`
      <furo-data-reference-search ƒ-bind-data="--field-injected"
                                  @-search="--term"
                                  value-field="{{.value_field}}"
                                  display-field="{{.display_field}}"
                                  ?condensed="${this.condensed}" {{if .search_on_enter_only}}
                                  search-on-enter-only {{end}}
                                  min-term-length="{{.min_term_length}}"
                                  no-result-hint="${i18n.t('furo.referencesearch.noresult.hint')}"
                                  ƒ-collection-in="--collection">
      </furo-data-reference-search>
      <furo-collection-agent
              service="{{.service_name}}"
              ƒ-hts-in="--field-injected(*.link._value), --htsUpdated"
              ƒ-search="--term"
              @-response="--collection">
      </furo-collection-agent>
    `;
  }
}

window.customElements.define('{{.component_name}}', {{.class_name}});
